<script>
	import * as _ from 'lamb';

	const defaultColor = 'yellow';
	const defaultString = '';

	export let color = defaultColor;
	export let regex;
	export let string = defaultString;

	const splitText = (text, regExp) => {
		const remains = text.split(regExp);

		let pairs;

		if (remains.length > 1) {
			const matches = text.match(regExp)?.concat('');
			pairs = _.zip(remains, matches);
		} else {
			pairs = [[text, '']];
		}

		return pairs;
	}

	$: string = string || defaultString;
	$: parts = splitText(string, regex);
	$: color = color || defaultColor;
	$: style = `background-color:${color}`;
</script>

{#each parts as [normal, styled]}{normal}{#if styled}<span {style}>{styled}</span>{/if}{/each}
